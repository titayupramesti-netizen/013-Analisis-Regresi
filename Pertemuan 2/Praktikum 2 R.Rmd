---
title: "Praktikum 2 Anreg"
author: "Tita Ayu Pramesti"
date: "`r Sys.Date()`"
output: 
  rmdformats::readthedown
---

# Data

## Membaca Data

Jika data berupa csv, maka tidak perlu pemanggilan `library(readxl)` karena R sudah memiliki fungsi bawaan terhadap hal tersebut. Apabila file .csv pada software excel ditunjukkan dengan delimiter “,” maka dapat menggunakan fungsi `read.csv`, apabila delimiter berupa “;” maka dapat menggunakan fungsi `read.csv2`.

```{r}
library(readxl)

data <- read_excel("C:/Users/Tita/Downloads/NSC-2025.xlsx", sheet="Sheet2")
head(data) #menampilkan sebagian data awal
```

## Menyesuaikan Peubah

Untuk mempermudah pemanggilan peubah pada saat eksplorasi dan analisis, jika pada file masih mengggunakan nama peubah yang panjang, maka bisa diganti dengan menggunakan fungsi `colnames()`. Kolom wilayah juga dapat dihapus dengan menggunakan syntax `namadata[,-1]` dengan -1 menunjukkan bahwa kolom pertama ingin dihapus.

```{r}
colnames(data) <- c("Kabupaten/Kota", "Y", paste0("X", 1:9))
head(data)
```

# Eksplorasi Data

```{r}
n <- nrow(data)
```

Saat ini terdapat 1 peubah Y dan 9 peubah X, misal ingin dilakukan eksplorasi dan analisis terkait peubah X1

```{r}
plot(data$X9, data$Y,
     main = "Rata-rata lama sekolah vs Indeks Pembangunan Manusia",
     xlab = "RLS",
     ylab = "IPM")
```

```{r}
summary(data$Y)
```

```{r}
boxplot(data$Y)
```

```{r}
summary(data$X9)
```

```{r}
boxplot(data$X9)
```

# Pembentukan Model

## Manual

### Koefisien Regresi

$\hat{y_i} = \hat{\beta_0} + \hat{\beta_1} x_{i}, i = 1,2, ..., n$ $\hat{\beta_1} = \frac{\sum(y_i - \bar{y}) - \sum(x_i - \bar{x})}{\sum(x_i - \bar{x})^2} = \frac{S_{xx}{S_{xy} atau$ $\hat{\beta_1} = \frac{\sum (x_iy)-\frac{\sum(x_i)\sum(y)}{n}}{\sum(x_i^2)-\frac{\sum(x_i^2)}{n}}$ $\hat{\beta_0} = \bar{y} - \hat{\beta_1} \bar{x}$

```{r}
x <- data$X1
y <- data$Y
```

```{r}
b1 <- (sum(x*y)-sum(x)*sum(y)/n)/(sum(x^2)-(sum(x)^2/n))
b0 <- mean(y)-b1*mean(x)

cat("Koefisien b0:", b0, "\n")  
cat("Koefisien b1:", b1, "\n")
```

### Standar Error Parameter Regresi

Standar error menunjukan seberapa besar ketidakpastian dalam estimasi koefisien

```{r}
galat <- y-(b0+b1*x)
ragam_galat <- sum(galat^2)/(n-2)

se_b0 <- sqrt(ragam_galat*(1/n+mean(x)^2/sum((x-mean(x))^2)))
se_b1 <- sqrt(ragam_galat/sum((x-mean(x))^2))

cat("Standar error b0:", se_b0, "\n") 
cat("Standar error b1:", se_b1, "\n")
```

### Signifikansi Parameter (nilai-t)

Nilai ini menunjukkan tingkat signifikansi secara parsial dari setiap koefisien peubah berdasarkan nilai t dan probabilitas nilai p

```{r}
t_b0 <- b0/se_b0
t_b1 <- b1/se_b1
p_b0 <- 2*pt(-abs(t_b0 ),df<-n-2)
p_b1 <- 2*pt(-abs(t_b1 ),df<-n-2)

cat("Nilai t pada b0 adalah", t_b0, "dengan nilai p sebesar", p_b0, "\n")  
```

```{r}
cat("Nilai t pada b1 adalah", t_b1, "dengan nilai p sebesar", p_b1, "\n") 
```

Nilai p kurang dari alpha 0.05 untuk b0 maupun b1 sehingga signifikan pada taraf nyata 5%

### Koefisien Determinasi dan Penyesuaiannya

Pada analisis regresi linier sederhana, koefisien determinasi yang digunakan adalah multiple R Squared, sedangkan regresi linier berganda menggunakan adjusted R Squared yang disesuaikan dengan banyaknya peubah

```{r}
r <- (sum(x*y)-sum(x)*sum(y)/n)/
sqrt((sum(x^2)-(sum(x)^2/n))*(sum(y^2)-(sum(y)^2/n)))
Koef_det <- r^2
Koef_det
```

```{r}
Adj_R2 <- 1-((1-Koef_det)*(n-1)/(n-1-1))
Adj_R2
```

### Signifikansi Simultan (F)

Nilai ini menunjukkan signifikansi dan kebaikan model secara simultan (bersamaan seluruh peubah) yang menjelaskan model secara keseluruhan memiliki hubungan berarti antara X dan Y

```{r}
galat<-y-(b0+b1*x)

JKG <- sum((y - (b0+b1*x))^2)
JKReg <- sum(((b0+b1*x)- mean(y))^2)
JKT <- sum((y - mean(y))^2)
JKT <- JKReg+JKG

dbReg <- 1
dbg <- n-2
dbt <- n-1

(Fhit <- (JKReg/dbReg)/(JKG/dbg))
```

```{r}
(p_Fhit <- 1-pf(Fhit, dbReg, dbg, lower.tail = F))
```

Nilai p kurang dari alpha 0.05 sehingga secara simultan X dan Y saling memengaruhi

## Menggunakan Fungsi `lm()`

Dalam penggunaan fungsi `lm()`, kita akan memperoleh secara langsung nilai-nilai pada pemodelan regresi dari data yang kita miliki. Hanya dengan mengeluarkan summary dan anova dari model yang terbentuk maka dapat diperoleh nilai parameter, signifikansinya, standar eror, koefisien determinasi hingga ukuran keragamannya.

```{r}
model <- lm(Y~X1, data = data)
summary(model)
```

Berdasarkan hasil diperoleh bahwa kedua cara valid dan memberikan hasil yang sama dalam membuat pemodelan regresi linear sederhana.

```{r}
anova(model)
```

# Kesimpulan

Model yang terbentuk adalah sebagai berikut:

$$\hat{Y} = 73.49741 + 0.4473984 X_1$$

dengan Y adalah Indeks Pembangunan Manuisia (IPM) dan X adalah Tingkat Pengangguran Terbuka (TPT).

Didapatkan nilai $\hat\beta_0 = 73.49741$ artinya nilai dugaan Indeks Pembangunan Manusia ketika Tingkat Pengangguran Terbuka bernilai 0% adalah 73.497%, akan tetapi nilai 0 tidak ada dalam selang tingkat pengangguran terbuka sehingga $\hat\beta_0$ tidak dapat didefinisikan lebih lanjut

Nilai $\hat\beta_1 = 0.4473984$ artinya nilai dugaan perubahan dugaan Indeks Pembangunan Manusia jika Tingkat Pengangguran Terbuka berubah satu tahun adalah sebesar 0.447%.

Koefisien determinasi yang dihasilkan adalah 0.02573685 atau 2.574% artinya keragamanTingkat Pengangguran Terbuka yang dapat dijelaskan oleh persentase akses sanitasi layak adalah sebesar 2.575%, sisanya yaitu 97.426% dijelaskan oleh peubah lain yang tidak dimasukkan dalam model.
