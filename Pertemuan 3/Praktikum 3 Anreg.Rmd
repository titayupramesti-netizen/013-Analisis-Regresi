---
title: "Praktikum 3 Anreg"
author: "Tita Ayu Pramesti"
date: "`r Sys.Date()`"
output: 
  rmdformats::readthedown
editor_options: 
  markdown: 
    wrap: 72
---

# Data

```{r}
library(readxl)
dt <- read_xlsx("C:\\Users\\Tita\\OneDrive\\Documents\\Semester 4\\Anreg\\DATA ANREG.xlsx")
dt
```

```{r}
y <- dt$"ASFR"
x <- dt$"Proporsi Perempuan Umur 20-24 Tahun Yang Berstatus Kawin Atau Berstatus Hidup Bersama Sebelum Umur 18 Tahun Menurut Provinsi (Persen)"
n <- length(dt)
```

```{r}
dt <- data.frame(cbind(y,x))
head(dt)
```

# Model

```{r}
model <- lm(y~x, dt)
summary(model)
```

Berdasarkan perhitungan, didapat dugaan persamaan regresi linear sebagai
berikut. Dugaan persamaan tersebut dapat pula disebut sebagai nilai
harapan dari peubah respons Y (Indeks Pembangunan Manusia)

$$E[\hat{Y}] = \hat{Y} = 3.6840 + 2.5241 X$$

# Penguraian Keragaman

Penguraian keragaman dugaan persamaan regresi linear dapat dilakukan
terlebih dahulu secara eksploratif melalui visualisasi sebagai berikut.
Dari scatter plot yang dihasilkan, dapat diamati dua persamaan garis,
yaitu $\hat{Y}$ sebagai nilai harapan $Y$ sekaligus dugaan persamaan dan
$\bar{Y}$ sebagai rata-rata dari seluruh nilai $Y_i$ yang ada.

```{r}
y.bar <- mean(y)
plot(x,y)
abline(model, col="red")
text(30, 220, "Y_duga", adj = c(-0.1, 1.5), col = "red", cex = 0.8)
abline(h=y.bar, col="blue")
text(31, 185, "Y_bar", adj = c(-0.1, 1.5), col = "blue", cex = 0.8)
```

Dari scatter plot di atas, teramati adanya amatan yang menyimpang
relatif terhadap nilai harapannya. Penyimpangan amatan dari nilai
harapannya inilah yang disebut sebagai galat. Keragaman dari galat tiap
amatan ini dapat diurai berdasarkan garis dugaan persamaan ($\hat{Y}$)
dan garis rataan nilai resposnya ($\bar{Y}$). Penguraian keragaman ini
dapat dituliskan sebagai Jumlah Kuadrat Regresi (JKR), Jumlah Kuadrat
Galat (JKG), dan Jumlah Kuadrat Total (JKT) dengan perhitungan sebagai
berikut.

$$\text{JKR} = \sum_{i=1}^{n} (\hat{y}_i - \bar{y})^2 ; \text{JKG} = \sum_{i=1}^{n} (y_i - \hat{y})^2 ; \text{JKT} = \sum_{i=1}^{n} (y_i - \bar{y})^2$$
Hubungan antara ketiganya dapat pula dituliskan sebagai berikut.

$$JKT = JKR + JKG$$ Nilai penguraian keragaman ini dapat diamati pula
menggunakan fungsi anova pada bagian **Sum Sq (Jumlah Kuadrat)** seperti
yang ditampilkan di bawah. Pada output sintaks di bawah, JKR model
bernilai 4235.1 dan JKG model bernilai 1761.6

```{r}
(anova.model <- anova(model))
```

Dari tabel ANOVA dan penguraian keragaman, dapat diduga pula ragam
galat/error dari model yang kita peroleh. Secara umum, error dari model
dapat diduga oleh nilai Kuadrat Tengah Galat (KTG) sehingga berdasarkan
output sintaks di atas, diketahui bahwa ragam galat dari model bernilai
55.05064. Hubungan antara keduanya dapat dituliskan sebagai berikut.

$$\sigma^2_e = S_{e}^2=  \text{KTG} = \frac{\text{JKG}}{n-2}$$

```{r}
(KTG <- anova.model$`Mean Sq`[2])
```

Dari nilai dugaan ragam galat di atas, dapat diduga pula nilai dugaan
dari simpangan bakunya. Dugaan simpangan baku inilah yang disebut
sebagai galat baku. Hubungan antara galat baku dan ragam galat dapat
dituliskan sebagai berikut.

$$S_e = \sqrt{S_{e}^2}$$

Oleh karena simpangan baku merupakan akar kuadrat dari ragam, maka nilai
dugaan galat baku model yang kita bentuk adalah
$S_e = \sqrt{55.05064} \approx 7.419612$

```{r}
(galat.baku <- sqrt(KTG))
```

# Keragaman Dugaan Parameter

## Dugaan Parameter $\beta_0$

Sebelumnya, melalui fungsi `lm` dan perhitungan manual yang sudah
dibahas pada pertemuan sebelumnya, kita sudah mendapatkan nilai dugaan
parameter β0 dan β1 sebesar 3.683993 dan 2.524083. Kedua nilai dugaan
parameter tersebut dapat kita definisikan sebagai berikut.

```{r}
(b0 <- model$coefficients[[1]])
(b1 <- model$coefficients[[2]])
```

Selanjutnya kita dapat menghitung nilai ragam dan t-hitung dari dugaan
parameter $β_0$ tersebut dengan perhitungan sebagai berikut.

$$\text{S}_{\hat{\beta_0}} = \sqrt{KTG \left[\frac{1}{n} + \frac{\bar{X}^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2}\right]} ; t_{h} = \frac{\hat{\beta_0} - \beta_0}{S_{\hat{\beta_0}}}$$
Nilai $\text{S}_{\hat{\beta_0}}$ dapat dihitung dengan sintaks sebagai
berikut

```{r}
(se_b0 <- sqrt(KTG*(1/n+mean(x)^2/sum((x-mean(x))^2))))
```

Jika dalam uji hipotesis kita ingin menguji apakah $\beta_0$, maka nilai
th dapat dihitung sebagai berikut.

```{r}
uji <- 0
(t_b0 <- (b0 - uji)/se_b0)
```

```{r}
abs(qt(0.025, df = n-2))
```

## Dugaan Parameter $\beta_1$

Sementara itu, ragam dan t-hitung dari dugaan parameter $\beta_1$ dapat
diperoleh dari perhitungan berikut.

$$\text{S}_{\hat{\beta_1}} = \sqrt{\frac{KTG}{\sum_{i=1}^{n}(x_i - \bar{x})^2}} ; t_{h} = \frac{\hat{\beta_1} - \beta_1}{S_{\hat{\beta_1}}}$$

Nilai $\text{S}_{\hat{\beta_1}}$ dapat dihitung dengan sintaks sebagai
berikut

```{r}
(se_b1 <- sqrt(KTG/sum((x-mean(x))^2)))
```

Jika dalam uji hipotesis kita ingin menguji apakah $\beta_1 = 0$, maka
nilai $t_h$ dapat dihitung sebagai berikut.

```{r}
uji <- 0
(t_b1 <- (b1 - uji)/se_b1)
```

```{r}
abs(qt(0.025, df = n-2))
```

# Selang Kepercayaan Parameter

Secara umum, kita dapat memahami bahwa selang kepercayaan untuk $β_0$
dan $β_1$ terdiri atas batas bawah dan batas atas yang dapat dituliskan
sebagai berikut.

$$\text{Selang Kepercayaan } \beta_0 : \hat{\beta_0} \pm t_{\alpha/2, n-2} S_{\hat{\beta_0}}$$
$$\text{Selang Kepercayaan } \beta_1 : \hat{\beta_1} \pm t_{\alpha/2, n-2} S_{\hat{\beta_1}}$$

Dengan menggunakan tingkat signifikansi $α = 0,05$, maka nilai
$t_{α/2,n-2}$ dapat dihitung sebagai berikut.

```{r}
t_table <- abs(qt(0.025, df = n-2))
t_table
```

Selanjutnya, selang kepercayaan untuk parameter $β_0$ dan $β_1$ dapat
dihitung sebagai berikut.

```{r}
# Selang kepercayaan beta0
lower_b0 <- b0 - t_table * se_b0
upper_b0 <- b0 + t_table * se_b0
cat("Selang kepercayaan beta0: [", lower_b0, ", ", upper_b0, "]\n")
```

```{r}
# Selang kepercayaan beta1
lower_b1 <- b1 - t_table * se_b1
upper_b1 <- b1 + t_table * se_b1
cat("Selang kepercayaan beta1: [", lower_b1, ", ", upper_b1, "]\n")
```

Sehigga dapat disimpulkan bahwa pada taraf signifikansi 5%, selang
kepercayaan untuk parameter $β_0$ adalah [-6.037357 , 13.40534] dan
untuk parameter $β_1$ adalah [1.8436 , 3.204566]

# Selang Kepercayaan

## Bagi Nilai Rataan/Nilai Harapan Amatan

Secara umum, kita dapat memahami bahwa selang kepercayaan untuk
$E(\hat{Y}|X=x_0)$ terdiri atas batas bawah dan batas atas yang dapat
dituliskan sebagai berikut.
$$ E(\hat{Y}|X=x_0) \pm t_{\alpha/2, n-2} S_e \sqrt{(\frac{1}{n} + \frac{(x_i - \bar{x})^2}{\sum_{1=1}^n(x_i-\bar{x})^2})}$$
Misalkan kita ingin menduga nilai rataan (harapan) amatan ketika nilai
x=10. Kita dapat memanfaatkan fungsi `predict` untuk mendapatkan nilai
dugaan dan selang kepercayaannya sebagai berikut.

```{r}
amatan.diduga <- data.frame(x=13)
predict(model, amatan.diduga, interval = "confidence")
```

Berdasarkan output sintaks di atas, diketahui bahwa dugaan rataan nilai
$Y$ ketika nilai x=13 adalah 36.49707. Selain itu, diindikasikan juga
bahwa dalam taraf kepercayaan 95%, diyakini bahwa nilai dugaan rataan
$Y$ ketika nilai x=13 berada dalam selang 33.74304 hingga 39.2511.

## Bagi Individu amatan

Secara umum, kita dapat memahami bahwa selang kepercayaan untuk
$\hat{y}(s_i)$terdiri atas batas bawah dan batas atas yang dapat
dituliskan sebagai berikut.

$$ \hat{y}(x_i)\pm t_{\alpha/2, n-2} S_e \sqrt{1+(\frac{1}{n} + \frac{(x_i - \bar{x})^2}{\sum_{1=1}^n(x_i-\bar{x})^2})}$$

Misalkan kita ingin menduga nilai individu amatan ketika nilai x=13.
Kita dapat memanfaatkan fungsi `predict` untuk mendapatkan nilai dugaan
dan selang kepercayaannya sebagai berikut.

```{r}
predict(model, amatan.diduga, interval = "prediction")
```

Berdasarkan output sintaks di atas, diketahui bahwa dugaan nilai
individu Y ketika nilai x=13 adalah 36.49707. Selain itu, diindikasikan
juga bahwa dalam taraf kepercayaan 95%, diyakini bahwa nilai amatan
individu Y ketika nilai x=13 berada dalam selang 21.13494 hingga
51.85921.
